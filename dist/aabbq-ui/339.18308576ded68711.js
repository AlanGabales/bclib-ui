"use strict";(self.webpackChunkaabbq_ui=self.webpackChunkaabbq_ui||[]).push([[339],{1339:(Rt,x,d)=>{d.r(x),d.d(x,{ORDERS_ROUTES:()=>Ht});var l=d(6814),o=d(6223),_=d(2787),g=d(1374),m=d(5195),A=d(2296),Z=d(2032),p=d(9157),s=d(5313),v=d(3365),T=d(3566),Y=d(617),b=d(8034),J=d(3307),Q=d(3680),t=d(5879),y=d(7398),h=d(1594),P=d(9862);let D=(()=>{class e{constructor(r,n){this.router=r,this.http=n}getAll(r){return this.http.get(`${h.N.apiUrl}/orders/${r}`)}create(r){return this.http.post(`${h.N.apiUrl}/orders`,r)}getById(r){return this.http.get(`${h.N.apiUrl}/orders/edit/${r}`)}update(r,n){return this.http.put(`${h.N.apiUrl}/orders/${r}`,n).pipe((0,y.U)(a=>a))}createDetail(r){return this.http.post(`${h.N.apiUrl}/order-details`,r)}updateDetail(r,n){return this.http.put(`${h.N.apiUrl}/order-details/${r}`,n).pipe((0,y.U)(a=>a))}deleteDetail(r){return this.http.delete(`${h.N.apiUrl}/order-details/delete/${r}`).pipe((0,y.U)(n=>n))}getDetailById(r){return this.http.get(`${h.N.apiUrl}/order-details/edit/${r}`)}}return e.\u0275fac=function(r){return new(r||e)(t.LFG(_.F0),t.LFG(P.eN))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function L(e,i){1&e&&(t.TgZ(0,"th",22),t._uU(1," ID "),t.qZA())}function M(e,i){if(1&e&&(t.TgZ(0,"td",23),t._uU(1),t.qZA()),2&e){const r=i.$implicit;t.xp6(1),t.hij(" ",r.id," ")}}function w(e,i){1&e&&(t.TgZ(0,"th",22),t._uU(1," Transaction Date "),t.qZA())}function B(e,i){if(1&e&&(t.TgZ(0,"td",23),t._uU(1),t.ALo(2,"date"),t.qZA()),2&e){const r=i.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,r.transaction_date,"MM/dd/yyyy")," ")}}function k(e,i){1&e&&(t.TgZ(0,"th",22),t._uU(1," OR # "),t.qZA())}function H(e,i){if(1&e&&(t.TgZ(0,"td",23),t._uU(1),t.qZA()),2&e){const r=i.$implicit;t.xp6(1),t.hij(" ",r.or_number," ")}}function R(e,i){1&e&&(t.TgZ(0,"th",22),t._uU(1," Ordered To "),t.qZA())}function $(e,i){if(1&e&&(t.TgZ(0,"td",23),t._uU(1),t.qZA()),2&e){const r=i.$implicit;t.xp6(1),t.hij(" ",r.ordered_to," ")}}function F(e,i){1&e&&(t.TgZ(0,"th",22),t._uU(1," Total Amount "),t.qZA())}function G(e,i){if(1&e&&(t.TgZ(0,"td",23),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&e){const r=i.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,r.total_amount,"PHP")," ")}}function j(e,i){1&e&&(t.TgZ(0,"th",22),t._uU(1," Payment Type "),t.qZA())}function z(e,i){if(1&e&&(t.TgZ(0,"td",23),t._uU(1),t.qZA()),2&e){const r=i.$implicit;t.xp6(1),t.hij(" ",r.payment_type," ")}}function K(e,i){1&e&&(t.TgZ(0,"th",24),t._uU(1," Action "),t.qZA())}function X(e,i){if(1&e&&(t.TgZ(0,"td",23)(1,"a",25),t._uU(2,"Edit"),t.qZA()()),2&e){const r=i.$implicit;t.xp6(1),t.MGl("routerLink","edit/",r.id,"")}}function V(e,i){1&e&&t._UZ(0,"tr",26)}function W(e,i){1&e&&t._UZ(0,"tr",27)}const tt=function(){return[10,20,50]};let et=(()=>{class e{constructor(r,n){this.orderService=r,this.datePipe=n,this.displayedColumns=["id","transaction_date","or_number","ordered_to","total_amount","payment_type","action"],this.filterDate=new o.NI(new Date)}ngOnInit(){this.getAll(new Date)}getAll(r){this.orderService.getAll(r).pipe((0,g.P)()).subscribe(n=>{this.orders=n,this.dataSource=new s.by(this.orders),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this.dataSource.filterPredicate=(a,u)=>{const f=new Date(a.transaction_date),C=new Date(u);return a.or_number?.toLocaleLowerCase().includes(u)||f.getFullYear()===C.getFullYear()&&f.getMonth()===C.getMonth()&&f.getDate()===C.getDate()}})}filterChange(r){this.dataSource.filter=r.target.value}exportTable(){J.E.exportTableToExcel("orders","Orders")}onDateChange(r){const n=r.value;console.log(this.datePipe.transform(n,"MM/dd/yyyy")),this.getAll(new Date(n)),this.dataSource.filter=this.datePipe.transform(n,"yyyy-MM-dd HH:mm:ss")}}return e.\u0275fac=function(r){return new(r||e)(t.Y36(D),t.Y36(l.uU))},e.\u0275cmp=t.Xpm({type:e,selectors:[["order-list-component"]],viewQuery:function(r,n){if(1&r&&(t.Gf(v.NW,5),t.Gf(T.YE,5)),2&r){let a;t.iGM(a=t.CRH())&&(n.paginator=a.first),t.iGM(a=t.CRH())&&(n.sort=a.first)}},standalone:!0,features:[t._Bn([l.uU]),t.jDz],decls:49,vars:9,consts:[[2,"margin-top","1%","margin-left","1%"],["matInput","","placeholder","Search here...",3,"keyup"],["matInput","",3,"matDatepicker","dateChange"],["matIconSuffix","",3,"for"],["startView","month",3,"startAt"],["picker",""],["routerLink","add","mat-raised-button","","color","primary",2,"margin-left","44%"],["mat-raised-button","","color","warn",2,"margin-left","1%",3,"click"],["id","orders","mat-table","","matSort","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["mat-sort-header","","mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","transaction_date"],["matColumnDef","or_number"],["matColumnDef","ordered_to"],["matColumnDef","total_amount"],["matColumnDef","payment_type"],["matColumnDef","action"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSize","pageSizeOptions"],["mat-sort-header","","mat-header-cell",""],["mat-cell",""],["mat-header-cell",""],[1,"btn","btn-sm","btn-primary","me-1",3,"routerLink"],["mat-header-row",""],["mat-row",""]],template:function(r,n){if(1&r&&(t.TgZ(0,"mat-card")(1,"h2",0),t._uU(2,"Orders"),t.qZA(),t.TgZ(3,"mat-card-header")(4,"mat-form-field")(5,"input",1),t.NdJ("keyup",function(u){return n.filterChange(u)}),t.qZA()(),t.TgZ(6,"mat-form-field")(7,"mat-label"),t._uU(8,"Filter transaction date"),t.qZA(),t.TgZ(9,"input",2),t.NdJ("dateChange",function(u){return n.onDateChange(u)}),t.qZA(),t.TgZ(10,"mat-hint"),t._uU(11,"MM/DD/YYYY"),t.qZA(),t._UZ(12,"mat-datepicker-toggle",3)(13,"mat-datepicker",4,5),t.qZA(),t.TgZ(15,"button",6),t._uU(16,"Create"),t.qZA(),t.TgZ(17,"button",7),t.NdJ("click",function(){return n.exportTable()}),t.TgZ(18,"mat-icon"),t._uU(19,"grid_on"),t.qZA(),t._uU(20,"Export"),t.qZA()(),t.TgZ(21,"mat-card-content")(22,"table",8),t.ynx(23,9),t.YNc(24,L,2,0,"th",10),t.YNc(25,M,2,1,"td",11),t.BQk(),t.ynx(26,12),t.YNc(27,w,2,0,"th",10),t.YNc(28,B,3,4,"td",11),t.BQk(),t.ynx(29,13),t.YNc(30,k,2,0,"th",10),t.YNc(31,H,2,1,"td",11),t.BQk(),t.ynx(32,14),t.YNc(33,R,2,0,"th",10),t.YNc(34,$,2,1,"td",11),t.BQk(),t.ynx(35,15),t.YNc(36,F,2,0,"th",10),t.YNc(37,G,3,4,"td",11),t.BQk(),t.ynx(38,16),t.YNc(39,j,2,0,"th",10),t.YNc(40,z,2,1,"td",11),t.BQk(),t.ynx(41,17),t.YNc(42,K,2,0,"th",18),t.YNc(43,X,3,1,"td",11),t.BQk(),t.YNc(44,V,1,0,"tr",19),t.YNc(45,W,1,0,"tr",20),t.qZA()(),t._UZ(46,"br"),t.TgZ(47,"mat-card-footer"),t._UZ(48,"mat-paginator",21),t.qZA()()),2&r){const a=t.MAs(14);t.xp6(9),t.Q6J("matDatepicker",a),t.xp6(3),t.Q6J("for",a),t.xp6(1),t.Q6J("startAt",n.filterDate),t.xp6(9),t.Q6J("dataSource",n.dataSource),t.xp6(22),t.Q6J("matHeaderRowDef",n.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns),t.xp6(3),t.Q6J("pageSize",10)("pageSizeOptions",t.DdM(8,tt))}},dependencies:[_.rH,l.ez,l.H9,l.uU,o.UX,m.QW,m.a8,m.dn,m.rt,m.dk,A.ot,A.lW,Z.c,Z.Nt,p.KE,p.hX,p.bx,p.R9,p.lN,s.p0,s.BZ,s.fO,s.as,s.w1,s.Dz,s.nj,s.ge,s.ev,s.XQ,s.Gk,v.TU,v.NW,T.JX,T.YE,T.nU,Y.Ps,Y.Hw,b.FA,b.Mq,b.hl,b.nW,Q.XK],styles:["mat-card[_ngcontent-%COMP%]{margin:2%;text-align:left}.mat-mdc-form-field[_ngcontent-%COMP%]{width:98%;margin:1%}.mat-50[_ngcontent-%COMP%]{width:48%;margin:1%}.mat-column-name[_ngcontent-%COMP%], .mat-column-description[_ngcontent-%COMP%]{width:20%}"]}),e})();var S=d(8525),q=d(4630),c=(()=>((c=c||{}).CASH="CASH",c.GCASH="GCASH",c.PAYMAYA="PAYMAYA",c.GRAB="GRAB",c.PANDA="PANDA",c))(),E=d(9744);function rt(e,i){1&e&&(t.TgZ(0,"span"),t._uU(1,"OR Number is required"),t.qZA())}function nt(e,i){if(1&e&&(t.TgZ(0,"mat-error"),t.YNc(1,rt,2,0,"span",4),t.qZA()),2&e){const r=t.oxw();t.xp6(1),t.Q6J("ngIf",r.f.or_number.errors.required)}}function it(e,i){1&e&&(t.TgZ(0,"span"),t._uU(1,"Ordered To is required"),t.qZA())}function ot(e,i){if(1&e&&(t.TgZ(0,"mat-error"),t.YNc(1,it,2,0,"span",4),t.qZA()),2&e){const r=t.oxw();t.xp6(1),t.Q6J("ngIf",r.f.ordered_to.errors.required)}}function at(e,i){1&e&&(t.TgZ(0,"span"),t._uU(1,"Address is required"),t.qZA())}function dt(e,i){if(1&e&&(t.TgZ(0,"mat-error"),t.YNc(1,at,2,0,"span",4),t.qZA()),2&e){const r=t.oxw();t.xp6(1),t.Q6J("ngIf",r.f.address.errors.required)}}function st(e,i){1&e&&(t.TgZ(0,"span"),t._uU(1,"Business Name is required"),t.qZA())}function mt(e,i){if(1&e&&(t.TgZ(0,"mat-error"),t.YNc(1,st,2,0,"span",4),t.qZA()),2&e){const r=t.oxw();t.xp6(1),t.Q6J("ngIf",r.f.business_name.errors.required)}}function lt(e,i){1&e&&(t.TgZ(0,"span"),t._uU(1,"Payment Type is required"),t.qZA())}function pt(e,i){if(1&e&&(t.TgZ(0,"mat-error"),t.YNc(1,lt,2,0,"span",4),t.qZA()),2&e){const r=t.oxw();t.xp6(1),t.Q6J("ngIf",r.f.payment_type.errors.required)}}function ut(e,i){1&e&&t._UZ(0,"span",32)}function ct(e,i){1&e&&(t.TgZ(0,"span"),t._uU(1,"Update"),t.qZA())}function ft(e,i){1&e&&(t.TgZ(0,"span"),t._uU(1,"Save"),t.qZA())}function _t(e,i){if(1&e){const r=t.EpF();t.TgZ(0,"span")(1,"button",33),t.NdJ("click",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.addDetail())}),t._uU(2,"Add"),t.qZA()()}}function ht(e,i){1&e&&(t.TgZ(0,"th",34),t._uU(1," ID "),t.qZA())}function gt(e,i){if(1&e&&(t.TgZ(0,"td",35),t._uU(1),t.qZA()),2&e){const r=i.$implicit;t.xp6(1),t.hij(" ",r.id," ")}}function At(e,i){1&e&&(t.TgZ(0,"th",34),t._uU(1," Product "),t.qZA())}function Zt(e,i){if(1&e&&(t.TgZ(0,"td",35),t._uU(1),t.qZA()),2&e){const r=i.$implicit;t.xp6(1),t.hij(" ",r.product.name," ")}}function Ct(e,i){1&e&&(t.TgZ(0,"th",34),t._uU(1," Qty "),t.qZA())}function Tt(e,i){if(1&e&&(t.TgZ(0,"td",35),t._uU(1),t.qZA()),2&e){const r=i.$implicit;t.xp6(1),t.hij(" ",r.qty," ")}}function bt(e,i){1&e&&(t.TgZ(0,"th",34),t._uU(1," Price "),t.qZA())}function yt(e,i){if(1&e&&(t.TgZ(0,"td",35),t._uU(1),t.qZA()),2&e){const r=i.$implicit;t.xp6(1),t.hij(" ",r.price," ")}}function qt(e,i){1&e&&(t.TgZ(0,"th",34),t._uU(1," Total "),t.qZA())}function Ut(e,i){if(1&e&&(t.TgZ(0,"td",35),t._uU(1),t.qZA()),2&e){const r=i.$implicit;t.xp6(1),t.hij(" ",r.total," ")}}function vt(e,i){1&e&&(t.TgZ(0,"th",36),t._uU(1," Action "),t.qZA())}function Dt(e,i){if(1&e){const r=t.EpF();t.TgZ(0,"td",35)(1,"button",37),t.NdJ("click",function(){const u=t.CHM(r).$implicit,f=t.oxw();return t.KtG(f.deleteDetail(u.id))}),t._uU(2,"Remove"),t.qZA()()}}function Nt(e,i){1&e&&t._UZ(0,"tr",38)}function xt(e,i){1&e&&t._UZ(0,"tr",39)}const U=function(e){return{"is-invalid":e}};let I=(()=>{class e{constructor(r,n,a,u,f){this.formBuilder=r,this.route=n,this.router=a,this.orderService=u,this.alertService=f,this.loading=!1,this.submitting=!1,this.submitted=!1,this.options={autoClose:!0,keepAfterRouteChange:!0},this.displayedColumns=["id","product","qty","price","total","action"]}ngOnInit(){this.id=this.route.snapshot.params.id,this.form=this.formBuilder.group({or_number:[""],ordered_to:["",o.kI.required],address:["",o.kI.required],business_name:["",o.kI.required],description:[""],payment_type:[c.CASH,o.kI.required]}),this.title="Add Order",this.id&&(this.title="Edit Order",this.loading=!0,this.orderService.getById(this.id).pipe((0,g.P)()).subscribe(r=>{this.orderDetails=r.details,this.dataSource=new s.by(this.orderDetails),this.totalAmount=r.total_amount?r.total_amount:0,this.form.patchValue(r),this.loading=!1}))}get f(){return this.form.controls}onSubmit(){this.submitted=!0,this.alertService.clear(),!this.form.invalid&&(this.submitting=!0,this.saveOrder().pipe((0,g.P)()).subscribe({next:r=>{this.alertService.success("Order saved",this.options),this.id&&(this.submitting=!1),this.router.navigateByUrl("/orders/edit/"+r.id)},error:r=>{this.alertService.error(r,this.options),this.submitting=!1}}))}saveOrder(){return this.id?this.orderService.update(this.id,this.form.value):this.orderService.create(this.form.value)}addDetail(){this.router.navigateByUrl("/orders/add-detail/"+this.id)}editDetail(r){this.router.navigateByUrl("/orders/edit-detail/"+r)}deleteDetail(r){this.deleteOrderDetail(r).pipe((0,g.P)()).subscribe({next:()=>{this.alertService.success("Order detail deleted",this.options),this.router.navigateByUrl("/orders/edit/"+this.id).then(()=>{window.location.reload()})},error:n=>{this.alertService.error(n,this.options)}})}deleteOrderDetail(r){return this.orderService.deleteDetail(r)}}return e.\u0275fac=function(r){return new(r||e)(t.Y36(o.qu),t.Y36(_.gz),t.Y36(_.F0),t.Y36(D),t.Y36(E.c))},e.\u0275cmp=t.Xpm({type:e,selectors:[["order-add-edit-component"]],standalone:!0,features:[t.jDz],decls:85,vars:31,consts:[[3,"formGroup","ngSubmit"],[2,"margin-top","1%","margin-left","1%"],[1,"mat-50"],["type","text","formControlName","or_number","matInput","",3,"ngClass"],[4,"ngIf"],["type","text","formControlName","ordered_to","matInput","",3,"ngClass"],["type","text","formControlName","address","matInput","",3,"ngClass"],["type","text","formControlName","business_name","matInput","",3,"ngClass"],["matNativeControl","","required","","formControlName","payment_type","matInput",""],["value","CASH"],["value","GCASH"],["value","PAYMAYA"],["value","GRAB"],["value","PANDA"],["matInput","","disabled","",3,"value"],["formControlName","description","matInput",""],[2,"margin","2%","text-align","right"],["mat-raised-button","","type","submit","color","primary",3,"disabled"],["class","spinner-border spinner-border-sm me-1",4,"ngIf"],["routerLink","/orders",1,"btn","btn-link"],["id","orderDetails","mat-table","","matSort","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["mat-sort-header","","mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","product"],["matColumnDef","qty"],["matColumnDef","price"],["matColumnDef","total"],["matColumnDef","action"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"spinner-border","spinner-border-sm","me-1"],["mat-raised-button","","color","primary",2,"margin-top","20%","margin-left","10%",3,"click"],["mat-sort-header","","mat-header-cell",""],["mat-cell",""],["mat-header-cell",""],["mat-raised-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(r,n){1&r&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return n.onSubmit()}),t.TgZ(1,"mat-card")(2,"mat-card-header")(3,"h2",1),t._uU(4),t.qZA()(),t.TgZ(5,"mat-card-content")(6,"mat-form-field",2)(7,"mat-label"),t._uU(8,"OR Number"),t.qZA(),t._UZ(9,"input",3),t.YNc(10,nt,2,1,"mat-error",4),t.qZA(),t.TgZ(11,"mat-form-field",2)(12,"mat-label"),t._uU(13,"Ordered to"),t.qZA(),t._UZ(14,"input",5),t.YNc(15,ot,2,1,"mat-error",4),t.qZA(),t.TgZ(16,"mat-form-field",2)(17,"mat-label"),t._uU(18,"Address"),t.qZA(),t._UZ(19,"input",6),t.YNc(20,dt,2,1,"mat-error",4),t.qZA(),t.TgZ(21,"mat-form-field",2)(22,"mat-label"),t._uU(23,"Business Name"),t.qZA(),t._UZ(24,"input",7),t.YNc(25,mt,2,1,"mat-error",4),t.qZA(),t.TgZ(26,"mat-form-field",2)(27,"mat-label"),t._uU(28,"Payment Type"),t.qZA(),t.TgZ(29,"select",8)(30,"option",9),t._uU(31,"CASH"),t.qZA(),t.TgZ(32,"option",10),t._uU(33,"GCASH"),t.qZA(),t.TgZ(34,"option",11),t._uU(35,"PAYMAYA"),t.qZA(),t.TgZ(36,"option",12),t._uU(37,"GRAB"),t.qZA(),t.TgZ(38,"option",13),t._uU(39,"PANDA"),t.qZA()(),t.YNc(40,pt,2,1,"mat-error",4),t.qZA(),t.TgZ(41,"mat-form-field",2)(42,"mat-label"),t._uU(43,"Total Amount"),t.qZA(),t._UZ(44,"input",14),t.ALo(45,"currency"),t.qZA(),t.TgZ(46,"mat-form-field",2)(47,"mat-label"),t._uU(48,"Description"),t.qZA(),t._UZ(49,"textarea",15),t.qZA()(),t.TgZ(50,"mat-card-footer")(51,"div",16)(52,"button",17),t.YNc(53,ut,1,0,"span",18),t.YNc(54,ct,2,0,"span",4),t.YNc(55,ft,2,0,"span",4),t.qZA(),t.TgZ(56,"a",19),t._uU(57,"Cancel"),t.qZA()()()()(),t.TgZ(58,"mat-card")(59,"mat-card-header")(60,"h2",1),t._uU(61," Order Details "),t.qZA(),t.YNc(62,_t,3,0,"span",4),t.qZA(),t.TgZ(63,"mat-card-content")(64,"table",20),t.ynx(65,21),t.YNc(66,ht,2,0,"th",22),t.YNc(67,gt,2,1,"td",23),t.BQk(),t.ynx(68,24),t.YNc(69,At,2,0,"th",22),t.YNc(70,Zt,2,1,"td",23),t.BQk(),t.ynx(71,25),t.YNc(72,Ct,2,0,"th",22),t.YNc(73,Tt,2,1,"td",23),t.BQk(),t.ynx(74,26),t.YNc(75,bt,2,0,"th",22),t.YNc(76,yt,2,1,"td",23),t.BQk(),t.ynx(77,27),t.YNc(78,qt,2,0,"th",22),t.YNc(79,Ut,2,1,"td",23),t.BQk(),t.ynx(80,28),t.YNc(81,vt,2,0,"th",29),t.YNc(82,Dt,3,0,"td",23),t.BQk(),t.YNc(83,Nt,1,0,"tr",30),t.YNc(84,xt,1,0,"tr",31),t.qZA()()()),2&r&&(t.Q6J("formGroup",n.form),t.xp6(4),t.Oqu(n.title),t.xp6(5),t.Q6J("ngClass",t.VKq(23,U,n.submitted&&n.f.or_number.errors)),t.xp6(1),t.Q6J("ngIf",n.submitted&&n.f.or_number.errors),t.xp6(4),t.Q6J("ngClass",t.VKq(25,U,n.submitted&&n.f.ordered_to.errors)),t.xp6(1),t.Q6J("ngIf",n.submitted&&n.f.ordered_to.errors),t.xp6(4),t.Q6J("ngClass",t.VKq(27,U,n.submitted&&n.f.address.errors)),t.xp6(1),t.Q6J("ngIf",n.submitted&&n.f.address.errors),t.xp6(4),t.Q6J("ngClass",t.VKq(29,U,n.submitted&&n.f.business_name.errors)),t.xp6(1),t.Q6J("ngIf",n.submitted&&n.f.business_name.errors),t.xp6(15),t.Q6J("ngIf",n.submitted&&n.f.payment_type.errors),t.xp6(4),t.s9C("value",t.xi3(45,20,n.totalAmount,"PHP")),t.xp6(8),t.Q6J("disabled",n.submitting),t.xp6(1),t.Q6J("ngIf",n.submitting),t.xp6(1),t.Q6J("ngIf",n.id),t.xp6(1),t.Q6J("ngIf",!n.id),t.xp6(7),t.Q6J("ngIf",n.id),t.xp6(2),t.Q6J("dataSource",n.dataSource),t.xp6(19),t.Q6J("matHeaderRowDef",n.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns))},dependencies:[l.O5,o.UX,o._Y,o.YN,o.Kr,o.Fj,o.EJ,o.JJ,o.JL,o.Q7,o.sg,o.u,l.mk,l.ez,l.H9,_.rH,m.QW,m.a8,m.dn,m.rt,m.dk,p.lN,p.KE,p.hX,p.TO,Z.c,Z.Nt,A.ot,A.lW,S.LD,q.Bb,s.p0,s.BZ,s.fO,s.as,s.w1,s.Dz,s.nj,s.ge,s.ev,s.XQ,s.Gk],styles:["mat-card[_ngcontent-%COMP%]{margin:2%;text-align:left}.mat-mdc-form-field[_ngcontent-%COMP%]{width:98%;margin:1%}.mat-50[_ngcontent-%COMP%]{width:48%;margin:1%}.mat-column-name[_ngcontent-%COMP%], .mat-column-description[_ngcontent-%COMP%]{width:20%}"]}),e})();var Yt=d(7921),Qt=d(3019),St=d(2048);function Et(e,i){1&e&&(t.TgZ(0,"span"),t._uU(1,"Product is required"),t.qZA())}function It(e,i){if(1&e&&(t.TgZ(0,"mat-error"),t.YNc(1,Et,2,0,"span",4),t.qZA()),2&e){const r=t.oxw();t.xp6(1),t.Q6J("ngIf",r.f.product.errors.required)}}function Ot(e,i){if(1&e&&(t.TgZ(0,"mat-option",16),t._uU(1),t.qZA()),2&e){const r=i.$implicit;t.Q6J("value",r),t.xp6(1),t.AsE(" ",r.name," - ",r.qty," ")}}function Jt(e,i){1&e&&(t.TgZ(0,"span"),t._uU(1,"Qty is required"),t.qZA())}function Pt(e,i){if(1&e&&(t.TgZ(0,"mat-error"),t.YNc(1,Jt,2,0,"span",4),t.qZA()),2&e){const r=t.oxw();t.xp6(1),t.Q6J("ngIf",r.f.qty.errors.required)}}function Lt(e,i){1&e&&(t.TgZ(0,"span"),t._uU(1,"Price is required"),t.qZA())}function Mt(e,i){if(1&e&&(t.TgZ(0,"mat-error"),t.YNc(1,Lt,2,0,"span",4),t.qZA()),2&e){const r=t.oxw();t.xp6(1),t.Q6J("ngIf",r.f.price.errors.required)}}function wt(e,i){1&e&&t._UZ(0,"span",17)}function Bt(e,i){1&e&&(t.TgZ(0,"span"),t._uU(1,"Update"),t.qZA())}function kt(e,i){1&e&&(t.TgZ(0,"span"),t._uU(1,"Save"),t.qZA())}const N=function(e){return{"is-invalid":e}};let O=(()=>{class e{constructor(r,n,a,u,f,C){this.formBuilder=r,this.route=n,this.router=a,this.orderService=u,this.productService=f,this.alertService=C,this.loading=!1,this.submitting=!1,this.submitted=!1,this.options={autoClose:!0,keepAfterRouteChange:!0}}ngOnInit(){this.orderId=this.route.snapshot.params.orderId,this.id=this.route.snapshot.params.id,this.form=this.formBuilder.group({product:["",o.kI.required],qty:[0,o.kI.required],price:[0,o.kI.required],total:[0],orderId:[this.orderId]}),this.title="Add Order Detail",this.id&&(this.title="Edit Order Detail",this.loading=!0,this.orderService.getDetailById(this.id).pipe((0,g.P)()).subscribe(r=>{this.orderId=r.order?.id,this.form.patchValue(r),this.loading=!1})),this.loadProducts(),this.filteredOptions=this.form.get("product").valueChanges.pipe((0,Yt.O)(""),(0,y.U)(r=>{const n="string"==typeof r?r:r?.name;return n?this._listfilter(n):this.products?.slice()})),this.sub=(0,Qt.T)(this.form.get("qty").valueChanges,this.form.get("price").valueChanges).subscribe(r=>{this.computeTotal()})}get f(){return this.form.controls}onSubmit(){this.submitted=!0,this.alertService.clear(),!this.form.invalid&&(this.submitting=!0,this.saveOrder().pipe((0,g.P)()).subscribe({next:r=>{this.alertService.success("Order saved",this.options),this.id&&(this.submitting=!1),this.router.navigateByUrl("/orders/edit/"+r.order?.id)},error:r=>{this.alertService.error(r,this.options),this.submitting=!1}}))}saveOrder(){return this.id?this.orderService.updateDetail(this.id,this.form.value):this.orderService.createDetail(this.form.value)}loadProducts(){this.productService.getAllEnabledQty().subscribe(r=>{this.products=r})}_listfilter(r){const n=r.toLowerCase();return this.products.filter(a=>a.name?.toLowerCase().includes(n))}displayFn(r){return r&&r.name?r.name+" - "+r.qty:""}computeTotal(){const r=+this.form.get("qty")?.value,n=+this.form.get("price")?.value;this.form.get("total")?.setValue(r*n)}}return e.\u0275fac=function(r){return new(r||e)(t.Y36(o.qu),t.Y36(_.gz),t.Y36(_.F0),t.Y36(D),t.Y36(St.M5),t.Y36(E.c))},e.\u0275cmp=t.Xpm({type:e,selectors:[["order-add-edit-detail-component"]],standalone:!0,features:[t.jDz],decls:39,vars:24,consts:[[3,"formGroup","ngSubmit"],[2,"margin-top","1%","margin-left","1%"],[1,"mat-50"],["type","text","placeholder","Select...","aria-label","Product","matInput","","formControlName","product",3,"ngClass","matAutocomplete"],[4,"ngIf"],["autoActiveFirstOption","",3,"displayWith"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["type","number","formControlName","qty","matInput","","min","0","OnlyNumber","true",3,"ngClass"],["input",""],["type","number","formControlName","price","matInput","","min","0","OnlyNumber","true",3,"ngClass"],["formControlName","total","matInput","","readonly",""],[2,"margin","2%","text-align","right"],["mat-raised-button","","type","submit","color","primary",3,"disabled"],["class","spinner-border spinner-border-sm me-1",4,"ngIf"],[1,"btn","btn-link",3,"routerLink"],[3,"value"],[1,"spinner-border","spinner-border-sm","me-1"]],template:function(r,n){if(1&r&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return n.onSubmit()}),t.TgZ(1,"mat-card")(2,"mat-card-header")(3,"h2",1),t._uU(4),t.qZA()(),t.TgZ(5,"mat-card-content")(6,"mat-form-field",2)(7,"mat-label"),t._uU(8,"Product"),t.qZA(),t._UZ(9,"input",3),t.YNc(10,It,2,1,"mat-error",4),t.TgZ(11,"mat-autocomplete",5,6),t.YNc(13,Ot,2,3,"mat-option",7),t.ALo(14,"async"),t.qZA()(),t.TgZ(15,"mat-form-field",2)(16,"mat-label"),t._uU(17,"Qty"),t.qZA(),t._UZ(18,"input",8,9),t.YNc(20,Pt,2,1,"mat-error",4),t.qZA(),t.TgZ(21,"mat-form-field",2)(22,"mat-label"),t._uU(23,"Price"),t.qZA(),t._UZ(24,"input",10,9),t.YNc(26,Mt,2,1,"mat-error",4),t.qZA(),t.TgZ(27,"mat-form-field",2)(28,"mat-label"),t._uU(29,"Total"),t.qZA(),t._UZ(30,"input",11),t.qZA()(),t.TgZ(31,"mat-card-footer")(32,"div",12)(33,"button",13),t.YNc(34,wt,1,0,"span",14),t.YNc(35,Bt,2,0,"span",4),t.YNc(36,kt,2,0,"span",4),t.qZA(),t.TgZ(37,"a",15),t._uU(38,"Cancel"),t.qZA()()()()()),2&r){const a=t.MAs(12);t.Q6J("formGroup",n.form),t.xp6(4),t.Oqu(n.title),t.xp6(5),t.Q6J("ngClass",t.VKq(18,N,n.submitted&&n.f.product.errors))("matAutocomplete",a),t.xp6(1),t.Q6J("ngIf",n.submitted&&n.f.product.errors),t.xp6(1),t.Q6J("displayWith",n.displayFn),t.xp6(2),t.Q6J("ngForOf",t.lcZ(14,16,n.filteredOptions)),t.xp6(5),t.Q6J("ngClass",t.VKq(20,N,n.submitted&&n.f.qty.errors)),t.xp6(2),t.Q6J("ngIf",n.submitted&&n.f.qty.errors),t.xp6(4),t.Q6J("ngClass",t.VKq(22,N,n.submitted&&n.f.price.errors)),t.xp6(2),t.Q6J("ngIf",n.submitted&&n.f.price.errors),t.xp6(7),t.Q6J("disabled",n.submitting),t.xp6(1),t.Q6J("ngIf",n.submitting),t.xp6(1),t.Q6J("ngIf",n.id),t.xp6(1),t.Q6J("ngIf",!n.id),t.xp6(1),t.MGl("routerLink","/orders/edit/",n.orderId,"")}},dependencies:[l.O5,o.UX,o._Y,o.Fj,o.wV,o.JJ,o.JL,o.qQ,o.sg,o.u,l.mk,l.ez,l.sg,l.Ov,_.rH,m.QW,m.a8,m.dn,m.rt,m.dk,p.lN,p.KE,p.hX,p.TO,Z.c,Z.Nt,A.ot,A.lW,S.LD,Q.ey,q.Bb,q.XC,q.ZL],styles:["mat-card[_ngcontent-%COMP%]{margin:2%;text-align:left}.mat-mdc-form-field[_ngcontent-%COMP%]{width:98%;margin:1%}.mat-50[_ngcontent-%COMP%]{width:48%;margin:1%}.mat-column-name[_ngcontent-%COMP%], .mat-column-description[_ngcontent-%COMP%]{width:20%}"]}),e})();const Ht=[{path:"",component:et},{path:"add",component:I},{path:"edit/:id",component:I},{path:"add-detail/:orderId",component:O},{path:"edit-detail/:id",component:O}]}}]);